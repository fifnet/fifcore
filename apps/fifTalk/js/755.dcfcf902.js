"use strict";(self["webpackChunkfifTalk"]=self["webpackChunkfifTalk"]||[]).push([[755],{14361:(e,a,o)=>{o.d(a,{Z:()=>W});var t=o(21073),l=o(18621);const n={class:"text-h6 text-weight-bold text-left text-uppercase"},i=(0,t._)("div",{id:"pay",style:{height:"230px"}},null,-1),s={class:"text-positive"};function r(e,a,o,r,d,c){const u=(0,t.up)("q-space"),p=(0,t.up)("q-btn"),m=(0,t.up)("q-card-section"),w=(0,t.up)("q-separator"),g=(0,t.up)("q-card-actions"),f=(0,t.up)("q-card"),b=(0,t.up)("q-dialog"),v=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(b,{ref:"dialogRef",onHide:r.onDialogHide},{default:(0,t.w5)((()=>[(0,t.Wm)(f,{class:"q-dialog-plugin"},{default:(0,t.w5)((()=>[(0,t.Wm)(m,{class:"row items-center q-pb-none q-my-sm"},{default:(0,t.w5)((()=>[(0,t._)("div",n,(0,l.zw)(r.title),1),(0,t.Wm)(u),(0,t.wy)((0,t.Wm)(p,{icon:"close",flat:"",round:"",dense:"",onClick:r.onCancelClick},null,8,["onClick"]),[[v]])])),_:1}),(0,t.Wm)(w,{inset:""}),(0,t.Wm)(m,null,{default:(0,t.w5)((()=>[i,(0,t._)("div",s,(0,l.zw)(r.message),1)])),_:1}),(0,t.Wm)(g,{align:"right"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{color:"primary",label:"OK",onClick:r.onOKClick},null,8,["onClick"]),(0,t.Wm)(p,{color:"primary",label:"Cancel",onClick:r.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}o(50254);var d=o(45970);let c=null;const u={name:"PayDlg",props:{payData:Object},emits:[...d.Z.emits],setup(e){const{dialogRef:a,onDialogHide:o,onDialogOK:t,onDialogCancel:l}=(0,d.Z)();async function n(){c||(c=new Opay2,await c.init({containerID:"pay",debug:!0})),c.setUI({close:!1,border:"0px"}),nblib.setOpay(c);const a=e.payData,o=await nblib.getDomain(a.owner);if(o){const e=await o.writePublicDomain({domain:a.nbdomain,kv:a.kv,tags:"zzTalk1"});console.log("update result:",e),t(e)}}return n(),{title:"Pay to procceed",message:"OK",dialogRef:a,onDialogHide:o,onOKClick(){t("test")},onCancelClick:l}}};var p=o(55152),m=o(61769),w=o(87551),g=o(59116),f=o(72155),b=o(11783),v=o(27362),k=o(55095),y=o(92106),C=o(60046),Z=o.n(C);const _=(0,p.Z)(u,[["render",r]]),W=_;Z()(u,"components",{QDialog:m.Z,QCard:w.Z,QCardSection:g.Z,QSpace:f.Z,QBtn:b.Z,QSeparator:v.Z,QCardActions:k.Z}),Z()(u,"directives",{ClosePopup:y.Z})},91755:(e,a,o)=>{o.r(a),o.d(a,{default:()=>te});var t=o(21073),l=o(18621);const n=(0,t.Uk)(" zzTalks ");function i(e,a,o,i,s,r){const d=(0,t.up)("q-btn"),c=(0,t.up)("q-toolbar-title"),u=(0,t.up)("q-toolbar"),p=(0,t.up)("q-header"),m=(0,t.up)("Boards"),w=(0,t.up)("q-list"),g=(0,t.up)("q-drawer"),f=(0,t.up)("router-view"),b=(0,t.up)("q-page-container"),v=(0,t.up)("q-layout");return(0,t.wg)(),(0,t.j4)(v,{view:"lHh Lpr lFf"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,null,{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Wm)(d,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:e.toggleLeftDrawer},null,8,["onClick"]),(0,t.Wm)(c,null,{default:(0,t.w5)((()=>[n])),_:1}),(0,t._)("div",null,(0,l.zw)(e.$q.version),1)])),_:1})])),_:1}),(0,t.Wm)(g,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":a[0]||(a[0]=a=>e.leftDrawerOpen=a),"show-if-above":"",bordered:""},{default:(0,t.w5)((()=>[(0,t.Wm)(w,null,{default:(0,t.w5)((()=>[(0,t.Wm)(m)])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(b,null,{default:(0,t.w5)((()=>[(0,t.Wm)(f)])),_:1})])),_:1})}var s=o(20744);const r=(0,t.Uk)(" Boards List "),d=(0,t.Uk)("Delete"),c=(0,t.Uk)("Leaves"),u=(0,t.Uk)("Roots");function p(e,a,o,n,i,s){const p=(0,t.up)("q-btn"),m=(0,t.up)("q-item-label"),w=(0,t.up)("q-avatar"),g=(0,t.up)("q-item-section"),f=(0,t.up)("q-item"),b=(0,t.up)("q-list"),v=(0,t.up)("q-menu"),k=(0,t.Q2)("close-popup"),y=(0,t.Q2)("ripple");return(0,t.wg)(),(0,t.iD)("div",null,[(0,t.Wm)(m,{header:""},{default:(0,t.w5)((()=>[r,(0,t.Wm)(p,{round:"",flat:"",color:"primary",icon:"add",onClick:a[0]||(a[0]=e=>n.onAdd())}),(0,t.Wm)(p,{round:"",flat:"",color:"primary",icon:"create",onClick:a[1]||(a[1]=e=>n.onCreate())})])),_:1}),((0,t.wg)(),(0,t.j4)(b,{key:n.listKey},{default:(0,t.w5)((()=>[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(n.boards,(e=>((0,t.wg)(),(0,t.iD)("div",{key:e.boardid,style:{"font-size":"20px"},class:"q-ma-sm"},[(0,t.wy)(((0,t.wg)(),(0,t.j4)(f,{clickable:"",exact:"",active:n.isActive(e.boardid),"active-class":"bg-teal-1 text-grey-8",onClick:a=>n.onClickBoard(e.boardid,a)},{default:(0,t.w5)((()=>[(0,t.Wm)(g,{avatar:""},{default:(0,t.w5)((()=>[(0,t.Wm)(w,{color:"primary","text-color":"white",size:"md",icon:n.getIcon(e)},null,8,["icon"])])),_:2},1024),(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[(0,t.Uk)((0,l.zw)(e.title),1)])),_:2},1024),(0,t.Wm)(p,{round:"",flat:"",color:"primary",icon:"more_vert"},{default:(0,t.w5)((()=>[(0,t.Wm)(v,{"touch-position":""},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{style:{"min-width":"100px"}},{default:(0,t.w5)((()=>[(0,t.wy)(((0,t.wg)(),(0,t.j4)(f,{clickable:"",onClick:a=>n.deleteBoard(e)},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[d])),_:1})])),_:2},1032,["onClick"])),[[k]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(f,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[c])),_:1})])),_:1})),[[k]]),(0,t.wy)(((0,t.wg)(),(0,t.j4)(f,{clickable:""},{default:(0,t.w5)((()=>[(0,t.Wm)(g,null,{default:(0,t.w5)((()=>[u])),_:1})])),_:1})),[[k]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["active","onClick"])),[[y]])])))),128))])),_:1}))])}var m=o(14361);const w={class:"text-h6 text-weight-bold text-left"},g={class:"text-negative"};function f(e,a,o,n,i,s){const r=(0,t.up)("q-space"),d=(0,t.up)("q-btn"),c=(0,t.up)("q-card-section"),u=(0,t.up)("q-separator"),p=(0,t.up)("q-input"),m=(0,t.up)("q-select"),f=(0,t.up)("q-card-actions"),b=(0,t.up)("q-card"),v=(0,t.up)("q-dialog"),k=(0,t.Q2)("close-popup");return(0,t.wg)(),(0,t.j4)(v,{ref:"dialogRef",onHide:n.onDialogHide},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{class:"q-dialog-plugin"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{class:"row items-center q-pb-none q-my-sm"},{default:(0,t.w5)((()=>[(0,t._)("div",w,(0,l.zw)(n.title),1),(0,t.Wm)(r),(0,t.wy)((0,t.Wm)(d,{icon:"close",flat:"",round:"",dense:"",onClick:n.onCancelClick},null,8,["onClick"]),[[k]])])),_:1}),(0,t.Wm)(u,{inset:""}),(0,t.Wm)(c,{class:"q-gutter-sm bg-gray-300"},{default:(0,t.w5)((()=>[(0,t.Wm)(p,{standard:"",hint:"nbdomain of the board",modelValue:n.nbdomain,"onUpdate:modelValue":a[0]||(a[0]=e=>n.nbdomain=e),dense:""},null,8,["modelValue"]),(0,t.Wm)(p,{standard:"",hint:"Title of the board",modelValue:n.boardTitle,"onUpdate:modelValue":a[1]||(a[1]=e=>n.boardTitle=e),dense:""},null,8,["modelValue"]),(0,t.Wm)(p,{standard:"",hint:"protect with password",modelValue:n.password,"onUpdate:modelValue":a[2]||(a[2]=e=>n.password=e),dense:""},null,8,["modelValue"]),(0,t._)("div",g,(0,l.zw)(n.message),1),(0,t.Wm)(m,{modelValue:n.selAccount,"onUpdate:modelValue":a[3]||(a[3]=e=>n.selAccount=e),label:"Account",options:n.accounts,class:"col-3"},null,8,["modelValue","options"])])),_:1}),(0,t.Wm)(f,{align:"right"},{default:(0,t.w5)((()=>[(0,t.Wm)(d,{color:"primary",label:"OK",onClick:n.onOKClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}o(50254);var b=o(45970),v=o(55034),k=o(57011);const y={name:"NewBoardDlg",props:{},emits:[...b.Z.emits],setup(){const{dialogRef:e,onDialogHide:a,onDialogOK:o,onDialogCancel:t}=(0,b.Z)(),l=(0,s.iH)(""),n=(0,s.iH)(""),i=(0,s.iH)(""),r=(0,s.iH)(""),d=(0,s.iH)(k.vc.lastAccount),c=(0,s.iH)(k.vc.accounts);return{title:"Create new board",selAccount:d,accounts:c,nbdomain:l,password:n,message:i,boardTitle:r,dialogRef:e,onDialogHide:a,async onOKClick(){const e=await v.r.inst().preCreateBoard(l.value);if(0!=e.code)return i.value=e.msg,void setTimeout((()=>i.value=""),5e3);k.vc.lastAccount=d.value,o({nbdomain:l.value,title:r.value,password:n.value,owner:d.value})},onCancelClick:t}}};var C=o(55152),Z=o(61769),_=o(87551),W=o(59116),q=o(72155),h=o(11783),Q=o(27362),D=o(53791),x=o(39424),H=o(55095),B=o(92106),O=o(60046),A=o.n(O);const P=(0,C.Z)(y,[["render",f]]),V=P;A()(y,"components",{QDialog:Z.Z,QCard:_.Z,QCardSection:W.Z,QSpace:q.Z,QBtn:h.Z,QSeparator:Q.Z,QInput:D.Z,QSelect:x.Z,QCardActions:H.Z}),A()(y,"directives",{ClosePopup:B.Z});var z=o(82398),T=o(40200),L=o(14716);const U={name:"Boards",setup(){const e=(0,s.iH)([]),a=(0,s.iH)(0),o=(0,z.Z)(),t=(0,T.tv)();async function l(){const a=await v.r.inst().dbGetAllBoards();e.value=a}function n(){o.dialog({title:"Add an existing board",message:"What is the board's NBdomain?",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((e=>{v.r.inst().addBoard(e)}))}function i(){o.dialog({component:V}).onOk((async e=>{console.log(e);const a=e.nbdomain.split("."),t=(a[1],a[2],{});e.type=e.password?k._E.boardType.hasPassword:"",e.boardid=e.nbdomain,e.extra={password:e.password},t[a[0]]={command:"create",data:{title:e.title,owner:e.owner,type:e.type}},e.password&&(t[a[0]].data.passHash=await L.Z.sha256(e.password));const l={type:"keyUpdate",owner:e.owner,nbdomain:a[1]+"."+a[2],kv:t};console.log(l),o.dialog({component:m.Z,componentProps:{payData:l}}).onOk((a=>{0==a.code&&v.r.inst().fire(k._E.boardPaid,e)})).onCancel((()=>{v.r.inst().fire(k._E.boardPaid,e)}))}))}return console.log("activeBoard:",k.GL.activeBoard),v.r.inst().sub(k._E.boardAdded,(()=>{l()})),v.r.inst().sub(k._E.boardDeleted,(()=>{l()})),v.r.inst().sub(k._E.boardAskPassword,(e=>new Promise((a=>{o.dialog({title:"Need password",message:`Please input password for ${e.title} (${e.boardid})`,prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((async o=>{const t=await L.Z.sha256(o);t==e.passHash&&(e.password=o),a(e)}))})))),l(),{listKey:a,boards:e,onAdd:n,onCreate:i,getIcon(e){let a="comment";return e.type&&-1!=e.type.indexOf("hasPassword")?"lock":a},deleteBoard(e){o.dialog({title:"Delete Board",message:"<div style='font-size:25px;'>Delete board: <strong>"+e.title+"</strong> ?</div><div style='font-size:15px;color:grey;'>it's only deleted locally.Other people could still see it</div>",cancel:!0,html:!0,persistent:!0}).onOk((()=>{v.r.inst().dbDeleteBoard(e.boardid)}))},onClickBoard(e,o){"more_vert"!=o.target.innerText&&(k.GL.activeBoard=e,t.push("/board/"+e),a.value++)},isActive(e){return k.GL.activeBoard==e}}}};var K=o(6984),j=o(65532),I=o(87440),R=o(60272),S=o(25838),E=o(22361),G=o(72789);const M=(0,C.Z)(U,[["render",p]]),N=M;A()(U,"components",{QItemLabel:K.Z,QBtn:h.Z,QList:j.Z,QItem:I.Z,QItemSection:R.Z,QAvatar:S.Z,QMenu:E.Z}),A()(U,"directives",{Ripple:G.Z,ClosePopup:B.Z});const $=(0,t.aZ)({name:"MainLayout",components:{Boards:N},setup(){const e=(0,s.iH)(!1);return{leftDrawerOpen:e,toggleLeftDrawer(){e.value=!e.value}}}});var F=o(85529),Y=o(86561),J=o(16829),X=o(75428),ee=o(73286),ae=o(50617);const oe=(0,C.Z)($,[["render",i]]),te=oe;A()($,"components",{QLayout:F.Z,QHeader:Y.Z,QToolbar:J.Z,QBtn:h.Z,QToolbarTitle:X.Z,QDrawer:ee.Z,QList:j.Z,QPageContainer:ae.Z})}}]);