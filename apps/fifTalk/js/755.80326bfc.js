"use strict";(self["webpackChunkfirsttalk"]=self["webpackChunkfirsttalk"]||[]).push([[755],{14361:(e,a,t)=>{t.d(a,{Z:()=>W});var o=t(21073),l=t(18621);const n={class:"text-h6 text-weight-bold text-left text-uppercase"},i=(0,o._)("div",{id:"pay",style:{height:"230px"}},null,-1),s={class:"text-positive"};function r(e,a,t,r,d,c){const u=(0,o.up)("q-space"),p=(0,o.up)("q-btn"),m=(0,o.up)("q-card-section"),w=(0,o.up)("q-separator"),g=(0,o.up)("q-card-actions"),f=(0,o.up)("q-card"),b=(0,o.up)("q-dialog"),v=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(b,{ref:"dialogRef",onHide:r.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(f,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(m,{class:"row items-center q-pb-none q-my-sm"},{default:(0,o.w5)((()=>[(0,o._)("div",n,(0,l.zw)(r.title),1),(0,o.Wm)(u),(0,o.wy)((0,o.Wm)(p,{icon:"close",flat:"",round:"",dense:"",onClick:r.onCancelClick},null,8,["onClick"]),[[v]])])),_:1}),(0,o.Wm)(w,{inset:""}),(0,o.Wm)(m,null,{default:(0,o.w5)((()=>[i,(0,o._)("div",s,(0,l.zw)(r.message),1)])),_:1}),(0,o.Wm)(g,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{color:"primary",label:"OK",onClick:r.onOKClick},null,8,["onClick"]),(0,o.Wm)(p,{color:"primary",label:"Cancel",onClick:r.onCancelClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}t(50254);var d=t(45970);let c=null;const u={name:"PayDlg",props:{payData:Object},emits:[...d.Z.emits],setup(e){const{dialogRef:a,onDialogHide:t,onDialogOK:o,onDialogCancel:l}=(0,d.Z)();async function n(){c||(c=new Opay2,await c.init({containerID:"pay",debug:!0})),c.setUI({close:!1,border:"0px"}),nblib.setOpay(c);const a=e.payData,t=await nblib.getDomain(a.owner);if(t){const e=await t.writePublicDomain({domain:a.nbdomain,kv:a.kv,tags:"zzTalk1"});console.log("update result:",e),o(e)}}return n(),{title:"Pay to procceed",message:"OK",dialogRef:a,onDialogHide:t,onOKClick(){o("test")},onCancelClick:l}}};var p=t(55152),m=t(61769),w=t(87551),g=t(59116),f=t(72155),b=t(11783),v=t(27362),k=t(55095),y=t(92106),C=t(60046),Z=t.n(C);const _=(0,p.Z)(u,[["render",r]]),W=_;Z()(u,"components",{QDialog:m.Z,QCard:w.Z,QCardSection:g.Z,QSpace:f.Z,QBtn:b.Z,QSeparator:v.Z,QCardActions:k.Z}),Z()(u,"directives",{ClosePopup:y.Z})},91755:(e,a,t)=>{t.r(a),t.d(a,{default:()=>oe});var o=t(21073),l=t(18621);const n=(0,o.Uk)(" zzTalks ");function i(e,a,t,i,s,r){const d=(0,o.up)("q-btn"),c=(0,o.up)("q-toolbar-title"),u=(0,o.up)("q-toolbar"),p=(0,o.up)("q-header"),m=(0,o.up)("Boards"),w=(0,o.up)("q-list"),g=(0,o.up)("q-drawer"),f=(0,o.up)("router-view"),b=(0,o.up)("q-page-container"),v=(0,o.up)("q-layout");return(0,o.wg)(),(0,o.j4)(v,{view:"lHh Lpr lFf"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,null,{default:(0,o.w5)((()=>[(0,o.Wm)(u,null,{default:(0,o.w5)((()=>[(0,o.Wm)(d,{flat:"",dense:"",round:"",icon:"menu","aria-label":"Menu",onClick:e.toggleLeftDrawer},null,8,["onClick"]),(0,o.Wm)(c,null,{default:(0,o.w5)((()=>[n])),_:1}),(0,o._)("div",null,(0,l.zw)(e.$q.version),1)])),_:1})])),_:1}),(0,o.Wm)(g,{modelValue:e.leftDrawerOpen,"onUpdate:modelValue":a[0]||(a[0]=a=>e.leftDrawerOpen=a),"show-if-above":"",bordered:""},{default:(0,o.w5)((()=>[(0,o.Wm)(w,null,{default:(0,o.w5)((()=>[(0,o.Wm)(m)])),_:1})])),_:1},8,["modelValue"]),(0,o.Wm)(b,null,{default:(0,o.w5)((()=>[(0,o.Wm)(f)])),_:1})])),_:1})}var s=t(20744);const r=(0,o.Uk)(" Boards List "),d=(0,o.Uk)("Delete"),c=(0,o.Uk)("Leaves"),u=(0,o.Uk)("Roots");function p(e,a,t,n,i,s){const p=(0,o.up)("q-btn"),m=(0,o.up)("q-item-label"),w=(0,o.up)("q-avatar"),g=(0,o.up)("q-item-section"),f=(0,o.up)("q-item"),b=(0,o.up)("q-list"),v=(0,o.up)("q-menu"),k=(0,o.Q2)("close-popup"),y=(0,o.Q2)("ripple");return(0,o.wg)(),(0,o.iD)("div",null,[(0,o.Wm)(m,{header:""},{default:(0,o.w5)((()=>[r,(0,o.Wm)(p,{round:"",flat:"",color:"primary",icon:"add",onClick:a[0]||(a[0]=e=>n.onAdd())}),(0,o.Wm)(p,{round:"",flat:"",color:"primary",icon:"create",onClick:a[1]||(a[1]=e=>n.onCreate())})])),_:1}),((0,o.wg)(),(0,o.j4)(b,{key:n.listKey},{default:(0,o.w5)((()=>[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(n.boards,(e=>((0,o.wg)(),(0,o.iD)("div",{key:e.boardid,style:{"font-size":"20px"},class:"q-ma-sm"},[(0,o.wy)(((0,o.wg)(),(0,o.j4)(f,{clickable:"",exact:"",active:n.isActive(e.boardid),"active-class":"bg-teal-1 text-grey-8",onClick:a=>n.onClickBoard(e.boardid,a)},{default:(0,o.w5)((()=>[(0,o.Wm)(g,{avatar:""},{default:(0,o.w5)((()=>[(0,o.Wm)(w,{color:"primary","text-color":"white",size:"md",icon:n.getIcon(e)},null,8,["icon"])])),_:2},1024),(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[(0,o.Uk)((0,l.zw)(e.title),1)])),_:2},1024),(0,o.Wm)(p,{round:"",flat:"",color:"primary",icon:"more_vert"},{default:(0,o.w5)((()=>[(0,o.Wm)(v,{"touch-position":""},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{style:{"min-width":"100px"}},{default:(0,o.w5)((()=>[(0,o.wy)(((0,o.wg)(),(0,o.j4)(f,{clickable:"",onClick:a=>n.deleteBoard(e)},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[d])),_:1})])),_:2},1032,["onClick"])),[[k]]),(0,o.wy)(((0,o.wg)(),(0,o.j4)(f,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[c])),_:1})])),_:1})),[[k]]),(0,o.wy)(((0,o.wg)(),(0,o.j4)(f,{clickable:""},{default:(0,o.w5)((()=>[(0,o.Wm)(g,null,{default:(0,o.w5)((()=>[u])),_:1})])),_:1})),[[k]])])),_:2},1024)])),_:2},1024)])),_:2},1024)])),_:2},1032,["active","onClick"])),[[y]])])))),128))])),_:1}))])}var m=t(14361);const w={class:"text-h6 text-weight-bold text-left"},g={class:"text-negative"};function f(e,a,t,n,i,s){const r=(0,o.up)("q-space"),d=(0,o.up)("q-btn"),c=(0,o.up)("q-card-section"),u=(0,o.up)("q-separator"),p=(0,o.up)("q-input"),m=(0,o.up)("q-select"),f=(0,o.up)("q-card-actions"),b=(0,o.up)("q-card"),v=(0,o.up)("q-dialog"),k=(0,o.Q2)("close-popup");return(0,o.wg)(),(0,o.j4)(v,{ref:"dialogRef",onHide:n.onDialogHide},{default:(0,o.w5)((()=>[(0,o.Wm)(b,{class:"q-dialog-plugin"},{default:(0,o.w5)((()=>[(0,o.Wm)(c,{class:"row items-center q-pb-none q-my-sm"},{default:(0,o.w5)((()=>[(0,o._)("div",w,(0,l.zw)(n.title),1),(0,o.Wm)(r),(0,o.wy)((0,o.Wm)(d,{icon:"close",flat:"",round:"",dense:"",onClick:n.onCancelClick},null,8,["onClick"]),[[k]])])),_:1}),(0,o.Wm)(u,{inset:""}),(0,o.Wm)(c,{class:"q-gutter-sm bg-gray-300"},{default:(0,o.w5)((()=>[(0,o.Wm)(p,{standard:"",hint:"nbdomain of the board",modelValue:n.nbdomain,"onUpdate:modelValue":a[0]||(a[0]=e=>n.nbdomain=e),dense:""},null,8,["modelValue"]),(0,o.Wm)(p,{standard:"",hint:"Title of the board",modelValue:n.boardTitle,"onUpdate:modelValue":a[1]||(a[1]=e=>n.boardTitle=e),dense:""},null,8,["modelValue"]),(0,o.Wm)(p,{standard:"",hint:"protect with password",modelValue:n.password,"onUpdate:modelValue":a[2]||(a[2]=e=>n.password=e),dense:""},null,8,["modelValue"]),(0,o._)("div",g,(0,l.zw)(n.message),1),(0,o.Wm)(m,{modelValue:n.selAccount,"onUpdate:modelValue":a[3]||(a[3]=e=>n.selAccount=e),label:"Account",options:n.accounts,class:"col-3"},null,8,["modelValue","options"])])),_:1}),(0,o.Wm)(f,{align:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(d,{color:"primary",label:"OK",onClick:n.onOKClick},null,8,["onClick"])])),_:1})])),_:1})])),_:1},8,["onHide"])}t(50254);var b=t(45970),v=t(55034),k=t(57011);const y={name:"NewBoardDlg",props:{},emits:[...b.Z.emits],setup(){const{dialogRef:e,onDialogHide:a,onDialogOK:t,onDialogCancel:o}=(0,b.Z)(),l=(0,s.iH)(""),n=(0,s.iH)(""),i=(0,s.iH)(""),r=(0,s.iH)(""),d=(0,s.iH)(k.vc.lastAccount),c=(0,s.iH)(k.vc.accounts);return{title:"Create new board",selAccount:d,accounts:c,nbdomain:l,password:n,message:i,boardTitle:r,dialogRef:e,onDialogHide:a,async onOKClick(){const e=await v.r.inst().preCreateBoard(l.value);if(0!=e.code)return i.value=e.msg,void setTimeout((()=>i.value=""),5e3);k.vc.lastAccount=d.value,t({nbdomain:l.value,title:r.value,password:n.value,owner:d.value})},onCancelClick:o}}};var C=t(55152),Z=t(61769),_=t(87551),W=t(59116),q=t(72155),h=t(11783),Q=t(27362),D=t(53791),x=t(39424),H=t(55095),B=t(92106),O=t(60046),A=t.n(O);const P=(0,C.Z)(y,[["render",f]]),V=P;A()(y,"components",{QDialog:Z.Z,QCard:_.Z,QCardSection:W.Z,QSpace:q.Z,QBtn:h.Z,QSeparator:Q.Z,QInput:D.Z,QSelect:x.Z,QCardActions:H.Z}),A()(y,"directives",{ClosePopup:B.Z});var z=t(82398),L=t(40200),U=t(14716);const K={name:"Boards",setup(){const e=(0,s.iH)([]),a=(0,s.iH)(0),t=(0,z.Z)(),o=(0,L.tv)();async function l(){const a=await v.r.inst().dbGetAllBoards();e.value=a}function n(){t.dialog({title:"Add an existing board",message:"What is the board's NBdomain?",prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((e=>{v.r.inst().addBoard(e)}))}function i(){t.dialog({component:V}).onOk((async e=>{console.log(e);const a=e.nbdomain.split("."),o=(a[1],a[2],{});e.type=e.password?k._E.boardType.hasPassword:"",e.boardid=e.nbdomain,e.extra={password:e.password},o[a[0]]={command:"create",data:{title:e.title,owner:e.owner,type:e.type}},e.password&&(o[a[0]].data.passHash=await U.Z.sha256(e.password));const l={type:"keyUpdate",owner:e.owner,nbdomain:a[1]+"."+a[2],kv:o};console.log(l),t.dialog({component:m.Z,componentProps:{payData:l}}).onOk((a=>{0==a.code&&v.r.inst().fire(k._E.boardPaid,e)})).onCancel((()=>{v.r.inst().fire(k._E.boardPaid,e)}))}))}return console.log("activeBoard:",k.GL.activeBoard),v.r.inst().sub(k._E.boardAdded,(()=>{l()})),v.r.inst().sub(k._E.boardDeleted,(()=>{l()})),v.r.inst().sub(k._E.boardAskPassword,(e=>new Promise((a=>{t.dialog({title:"Need password",message:`Please input password for ${e.title} (${e.boardid})`,prompt:{model:"",type:"text"},cancel:!0,persistent:!0}).onOk((async t=>{const o=await U.Z.sha256(t);o==e.passHash&&(e.password=t),a(e)}))})))),l(),{listKey:a,boards:e,onAdd:n,onCreate:i,getIcon(e){let a="comment";return e.type&&-1!=e.type.indexOf("hasPassword")?"lock":a},deleteBoard(e){t.dialog({title:"Delete Board",message:"<div style='font-size:25px;'>Delete board: <strong>"+e.title+"</strong> ?</div><div style='font-size:15px;color:grey;'>it's only deleted locally.Other people could still see it</div>",cancel:!0,html:!0,persistent:!0}).onOk((()=>{v.r.inst().dbDeleteBoard(e.boardid)}))},onClickBoard(e,t){"more_vert"!=t.target.innerText&&(k.GL.activeBoard=e,o.push("/board/"+e),a.value++)},isActive(e){return k.GL.activeBoard==e}}}};var T=t(6984),j=t(65532),I=t(87440),R=t(60272),S=t(25838),E=t(22361),G=t(72789);const M=(0,C.Z)(K,[["render",p]]),N=M;A()(K,"components",{QItemLabel:T.Z,QBtn:h.Z,QList:j.Z,QItem:I.Z,QItemSection:R.Z,QAvatar:S.Z,QMenu:E.Z}),A()(K,"directives",{Ripple:G.Z,ClosePopup:B.Z});const $=(0,o.aZ)({name:"MainLayout",components:{Boards:N},setup(){const e=(0,s.iH)(!1);return{leftDrawerOpen:e,toggleLeftDrawer(){e.value=!e.value}}}});var F=t(85529),Y=t(86561),J=t(16829),X=t(75428),ee=t(73286),ae=t(50617);const te=(0,C.Z)($,[["render",i]]),oe=te;A()($,"components",{QLayout:F.Z,QHeader:Y.Z,QToolbar:J.Z,QBtn:h.Z,QToolbarTitle:X.Z,QDrawer:ee.Z,QList:j.Z,QPageContainer:ae.Z})}}]);